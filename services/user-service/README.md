# API сервиса управления пользователями

Реализован на основе фреймворка [fastapi-users](https://fastapi-users.github.io/fastapi-users/10.1/)

# Зависимости

Перед запуском сервиса необходимо установить зависимости из файла requirements.txt

```
pip install -r requirements.txt
```

# Путь до исполняемого файла

EvoFP/services/user-service/src

# Запуск

```
uvicorn src:app --reload
```

# Сборка образа

```
docker build -t user-service:user .
```

# Запуск с использование файла конфигурации .env

Для запуска из файла конфигурации нужно поместить файл .env в корень сервиса

# Создание пользователя

- Для регистрации пользователя необходимо пройти по [URL](http://127.0.0.1:5000/docs#/auth/register_register_auth_register_post) и заполнить информацию о пользователе. По умолчанию "group_id" будет равна 2 (Пользователь), какую бы пользователь не выбрал при регистрации.

# Наделение пользователя правами администратора

- Необходимо проверить, что контейнер **postgresql** запущен и работает

```
docker ps
```

- Подключиться к контейнеру **postgresql** используя терминал

```
docker-compose exec postgresql bash
```

- Ввести данные для подключения к контейнеру

```
psql -U postgres -d postgres
```

- Присвоить права администратора выбранному пользователю используя SQL запрос

```
UPDATE "user"
SET is_superuser = true, group_id = 1
WHERE id = 'тут указать id пользователя, которому будут присвоены права администратора';
```

# Документация

После запуска доступна документация: http://127.0.0.1:8000/docs
